<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-takelage-cli">takelage-cli</h1>

<p><em>takelage-cli</em> is a command line interface to facilitate the takelage devops workflow. The takelage devops workflow helps devops engineers build, test and deploy os images.</p>

<p>The <em>takelage-cli</em> executable <em>tau</em> is a <a href="https://www.ruby-lang.org/">ruby</a> command line script using the <a href="http://whatisthor.com/">thor</a> toolkit.</p>

<h2 id="label-Ecosystem">Ecosystem</h2>

<p>The takelage devops framework consists of these projects:</p>

<p>| App | Description | | — | ———– | | <em><a href="https://github.com/geospin-takelage/takelage-cli">takelage-cli</a></em> | takelage command line interface | | <em><a href="https://github.com/geospin-takelage/takelage-dev">takelage-dev</a></em> | takelage development environment | | <em><a href="https://github.com/geospin-takelage/takelage-bit">takelage-bit</a></em> | takelage <a href="https://github.com/teambit/bit">bit</a> server |</p>

<h2 id="label-Installation">Installation</h2>

<p><em>tau</em> is part of <em>takelage-dev</em>&#39;s docker image but you typically want to install it on the host system as well. Install the takelage gem and its dependencies through the <a href="https://github.com/rubygems/rubygems">gem</a> command line tool:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_gem'>gem</span> <span class='id identifier rubyid_install'>install</span> <span class='id identifier rubyid_takelage'>takelage</span> <span class='id identifier rubyid_thor'>thor</span> <span class='id identifier rubyid_fylla'>fylla</span> <span class='id identifier rubyid_logger'>logger</span> <span class='id identifier rubyid_json'>json</span>
</code></pre>

<h2 id="label-Commands">Commands</h2>

<p><em>takelage-cli</em> uses <a href="https://github.com/cucumber/cucumber">cucumber</a> to system test its features. You are encouraged to read the cucumber feature files for the <em>tau</em> commands to get an idea of how the commands work. You can list the <em>tau</em> commands by running <em>tau <a href="features/takelage/self/self.list.feature">self list</a></em> or <em>tau list</em>:</p>

<p>Command | Description ——- | ———– tau config | # Alias for tau <a href="features/takelage/self/self.config.active.feature">self config active</a> tau copy [DIR] [SCOPE] | # Alias for tau <a href="features/takelage/bit/bit.clipboard.copy.feature">bit clipboard copy</a> tau list | # Alias for tau <a href="features/takelage/self/self.list.feature">self list</a> tau login | # Alias for tau <a href="features/takelage/docker/docker.container.login.feature">docker container login</a> tau nuke | # Alias for tau <a href="features/takelage/docker/docker.container.nuke.feature">docker container nuke</a> tau paste [COMPONENT] [DIR] | # Alias for tau <a href="features/takelage/bit/bit.clipboard.paste.feature">bit clipboard paste</a> tau project | # Alias for tau <a href="features/takelage/info/info.project.active.feature">info project active</a> tau pull | # Alias for tau <a href="features/takelage/bit/bit.clipboard.pull.feature">bit clipboard pull</a> tau purge | # Alias for tau <a href="features/takelage/docker/docker.container.purge.feature">docker container purge</a> tau push | # Alias for tau <a href="features/takelage/bit/bit.clipboard.push.feature">bit clipboard push</a> tau update | # Alias for tau <a href="features/takelage/docker/docker.image.update.feature">docker image update</a> tau version | # Alias for tau <a href="features/takelage/self/self.version.feature">self version</a> tau <a href="features/takelage/bit/bit.clipboard.copy.feature">bit clipboard copy</a> [DIR] [SCOPE] | # Copy new [DIR] to [SCOPE] tau <a href="features/takelage/bit/bit.clipboard.paste.feature">bit clipboard paste</a> [COMPONENT] [DIR] | # Paste bit [COMPONENT] into [DIR] tau <a href="features/takelage/bit/bit.clipboard.pull.feature">bit clipboard pull</a> | # Pull all updates for bit components from bit remote scopes tau <a href="features/takelage/bit/bit.clipboard.push.feature">bit clipboard push</a> | # Push all updates of bit components to bit remote scopes tau <a href="features/takelage/bit/bit.scope.add.feature">bit scope add</a> [SCOPE] | # Add a bit [SCOPE] tau <a href="features/takelage/bit/bit.scope.list.feature">bit scope list</a> | # List bit remote scopes tau <a href="features/takelage/bit/bit.scope.new.feature">bit scope new</a> [SCOPE] | # Init a new bit [SCOPE] tau <a href="features/takelage/completion/completion.bash.feature">completion bash</a> | # Print bash completion code tau <a href="features/takelage/docker/docker.container.check.existing.feature">docker container check existing</a> [CONTAINER] | # Check if docker [CONTAINER] is existing tau <a href="features/takelage/docker/docker.container.check.orphaned.feature">docker container check orphaned</a> [CONTAINER] | # Check if docker [CONTAINER] is orphaned tau <a href="features/takelage/docker/docker.container.command.feature">docker container command</a> [CMD] | # Run [CMD] in a docker container tau <a href="features/takelage/docker/docker.container.daemon.feature">docker container daemon</a> | # Run docker container in daemon mode tau <a href="features/takelage/docker/docker.container.login.feature">docker container login</a> | # Log in to latest local docker container tau <a href="features/takelage/docker/docker.container.nuke.feature">docker container nuke</a> | # Remove all docker containers tau <a href="features/takelage/docker/docker.container.purge.feature">docker container purge</a> | # Remove orphaned docker containers tau <a href="features/takelage/docker/docker.image.tag.check.local.feature">docker image tag check local</a> [TAG] | # Check if local docker image [TAG] exists tau <a href="features/takelage/docker/docker.image.tag.check.remote.feature">docker image tag check remote</a> [TAG] | # Check if remote docker image [TAG] exists tau <a href="features/takelage/docker/docker.image.tag.latest.local.feature">docker image tag latest local</a> | # Print latest local docker image tag tau <a href="features/takelage/docker/docker.image.tag.latest.remote.feature">docker image tag latest remote</a> | # Print latest remote docker image tag tau <a href="features/takelage/docker/docker.image.tag.list.local.feature">docker image tag list local</a> | # Print local docker image tags tau <a href="features/takelage/docker/docker.image.tag.list.remote.feature">docker image tag list remote</a> | # Print remote docker image tags tau <a href="features/takelage/docker/docker.image.update.feature">docker image update</a> | # Get latest remote docker container tau <a href="features/takelage/docker/docker.socket.start.feature">docker socket start</a> | # Start sockets for docker container tau <a href="features/takelage/docker/docker.socket.stop.feature">docker socket stop</a> | # Stop sockets for docker container tau <a href="features/takelage/git/git.check.clean.feature">git check clean</a> | # Check if the git workspace is clean tau <a href="features/takelage/git/git.check.master.feature">git check master</a> | # Check if we are on the git master branch tau <a href="features/takelage/git/git.check.workspace.feature">git check workspace</a> | # Check if a git workspace exists tau <a href="features/takelage/info/info.project.active.feature">info project active</a> | # Print active project info tau <a href="features/takelage/info/info.project.private.feature">info project private</a> | # Print private project info tau <a href="features/takelage/info/info.project.main.feature">info project main</a> | # Print main project info tau <a href="features/takelage/self/self.config.active.feature">self config active</a> | # Print active takelage configuration tau <a href="features/takelage/self/self.config.default.feature">self config default</a> | # Print takelage default configuration tau <a href="features/takelage/self/self.config.home.feature">self config home</a> | # Print takelage home config file configuration tau <a href="features/takelage/self/self.config.project.feature">self config project</a> | # Print takelage project config file configuration tau <a href="features/takelage/self/self.list.feature">self list</a> | # List all commands tau <a href="features/takelage/self/self.version.feature">self version</a> | # Print tau semantic version number</p>

<h2 id="label-Configuration">Configuration</h2>

<h3 id="label-Configuration+Files">Configuration Files</h3>

<p><em>takelage-cli</em> uses three different YAML configuration files which have different precedences. They are merged to an active configuration during runtime which can be inspected with <em>tau <a href="features/takelage/self/self.config.active.feature">self config active</a></em> or <em>tau config</em>.</p>

<p>| Filename | Precedence | Description | | ——– | ———- | ———– | | <em>default.yml</em> | lowest | Shipped with <em>takelage-cli</em>. Sets defaults where applicable. | | <em>~/.takelage.yml</em> | normal | User-wide configuration file in your home directory. This is your normal custom configuration file. | | <em>takelage.yml</em> | highest | Project-specific configuration file next to your main Rakefile. Some projects need special configuration. |</p>

<h3 id="label-Configuration+Examples">Configuration Examples</h3>
<ul><li>
<p>You should the following configuration items in your <em>~/.takelage.yml</em>:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
bit_remote: &#39;ssh://bit@bit.example.com:2222:/bit&#39;
bit_ssh: &#39;ssh -p 2222 bit@bit.example.com&#39;
docker_image: &#39;takelage&#39;
docker_repo: &#39;hub.example.com&#39;
docker_tagsurl: &#39;https://hub.example.com/v2/repositories/library/takelage/tags&#39;
</code></pre>
<ul><li>
<p>If you want to pin a specific docker tag for one of your projects then create an <em>takelage.yml</em> file with:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
docker_tag: &#39;1.2.3&#39;
</code></pre>
<ul><li>
<p>The cucumber tests make use of an <em>~/.takelage.yml</em> to overwrite defaults like:</p>
</li></ul>

<pre class="code ruby"><code class="ruby">---
docker_image: takelage-mock
</code></pre>

<h3 id="label-Project+Files">Project Files</h3>

<p><em>tau</em> reads two different YAML project files which have different precedences. They are merged to an active configuration during runtime which can be inspected with <em>tau <a href="features/takelage/info/info.project.active.feature">info project active</a></em> or <em>tau project</em>.</p>

<p>| Default filename | Config key | Precedence | Description | | ——– | ———- | ———- | ———– | | <em>project.yml</em> | info_project_main | normal | Main project file. | | <em>ansible/group_vars/private/project.yml</em> | info_project_private | highest | Private project file. Should be in <em>.gitignore</em>. |</p>

<h3 id="label-Bash+Completion">Bash Completion</h3>

<p>Add this to your <a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html">bash startup files</a>:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_source'>source</span> <span class='op'>&lt;</span><span class='lparen'>(</span><span class='id identifier rubyid_tau'>tau</span> <span class='id identifier rubyid_completion'>completion</span> <span class='id identifier rubyid_bash'>bash</span><span class='rparen'>)</span>
</code></pre>

<h3 id="label-Software+Tests">Software Tests</h3>

<p><em>takelage-cli</em> ships with <a href="https://github.com/cucumber/cucumber">cucumber</a> ruby tests. It uses cucumber&#39;s <a href="https://github.com/cucumber/aruba">aruba</a> extension and especially its <a href="https://relishapp.com/cucumber/aruba/v/0-11-0/docs/filesystem">filesystem</a> library.</p>

<p><em>takelage-cli</em> deploys a private docker <a href="https://docs.docker.com/registry/deploying/">registry</a> to conduct end-to-end tests of <em>tau docker</em> commands. The registry exposes port 5005. You need to whitelist it in your host&#39;s docker engine configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='lbrace'>{</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>insecure-registries</span><span class='label_end'>&quot;:</span> <span class='lbracket'>[</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>host.docker.internal:5005</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbracket'>]</span>
<span class='rbrace'>}</span>
</code></pre>
</div></div>

      <div id="footer">
  Generated on Wed Mar 25 09:49:59 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.6.3).
</div>

    </div>
  </body>
</html>